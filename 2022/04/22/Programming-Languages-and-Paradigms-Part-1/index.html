<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="A programming paradigm is a fundamental style of programming used to classify programming languages.">
<meta property="og:type" content="article">
<meta property="og:title" content="Programming Languages and Paradigms -- Part 1">
<meta property="og:url" content="http://example.com/2022/04/22/Programming-Languages-and-Paradigms-Part-1/index.html">
<meta property="og:site_name" content="YangOcean">
<meta property="og:description" content="A programming paradigm is a fundamental style of programming used to classify programming languages.">
<meta property="og:locale">
<meta property="og:image" content="https://olivierpierre.github.io/comp26020/slides/11-dynamic-memory-allocation/include/2d-3.svg">
<meta property="article:published_time" content="2022-04-22T00:15:41.000Z">
<meta property="article:modified_time" content="2022-04-27T21:17:09.946Z">
<meta property="article:author" content="Yangyang Cui">
<meta property="article:tag" content="C">
<meta property="article:tag" content="26020 Programming Languages and Paradigms">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://olivierpierre.github.io/comp26020/slides/11-dynamic-memory-allocation/include/2d-3.svg">


<link rel="canonical" href="http://example.com/2022/04/22/Programming-Languages-and-Paradigms-Part-1/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>
<script type="text/javascript">
  // Wait for the page to load first
  var _prevOnload = window.onload;
  window.onload = function() {
      var switchLang = document.getElementsByClassName("menu-item menu-item-switch_lang")[0];
      switchLang.onclick = function() {
          var href = window.location.href;
          var indexOfEn = href.toLowerCase().indexOf('/en/');
          if(indexOfEn !== -1) {
              window.location.href = href.replace('/en/', '/');
          }
          else {
              window.location.href = href.replace(/(^http[s]?:\/\/[a-z0-9.]*[:?0-9]*\/)(.*)/i, '$1en/$2');
          }
          if(typeof(_prevOnload) === 'function') {
              _prevOnload();
          }
          return false;
      }
  }
</script><title>Programming Languages and Paradigms -- Part 1 | YangOcean</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">YangOcean</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Second year in University of Manchetser</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-switch_lang"><a href="/en" rel="section"><i class="language fa-fw"></i>English</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Main-Programming-Paradigms-and-Sub-Paradigms"><span class="nav-number">1.</span> <span class="nav-text">Main Programming Paradigms and Sub-Paradigms</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Imperative"><span class="nav-number">1.1.</span> <span class="nav-text">Imperative</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Declarative"><span class="nav-number">1.2.</span> <span class="nav-text">Declarative</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multi-Paradigm-Languages"><span class="nav-number">1.3.</span> <span class="nav-text">Multi-Paradigm Languages</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction-to-C"><span class="nav-number">2.</span> <span class="nav-text">Introduction to C</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pros"><span class="nav-number">2.1.</span> <span class="nav-text">Pros:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cons"><span class="nav-number">2.2.</span> <span class="nav-text">Cons:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hello-World"><span class="nav-number">2.3.</span> <span class="nav-text">Hello World</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C-%E2%80%93-Variables-Types-Printing-to-the-Console"><span class="nav-number">3.</span> <span class="nav-text">C – Variables, Types, Printing to the Console</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Variables"><span class="nav-number">3.1.</span> <span class="nav-text">Variables:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Types"><span class="nav-number">3.2.</span> <span class="nav-text">Types:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Printing-to-the-Console-printf"><span class="nav-number">3.3.</span> <span class="nav-text">Printing to the Console: printf</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Arrays-Strings-Command-Line-Arguments"><span class="nav-number">4.</span> <span class="nav-text">Arrays, Strings, Command Line Arguments</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Arrays"><span class="nav-number">4.1.</span> <span class="nav-text">Arrays</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Command-Line-Arguments"><span class="nav-number">4.2.</span> <span class="nav-text">Command Line Arguments</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conditionals-and-Loops-in-C"><span class="nav-number">5.</span> <span class="nav-text">Conditionals and Loops in C</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Conditionals"><span class="nav-number">5.1.</span> <span class="nav-text">Conditionals</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Loops"><span class="nav-number">5.2.</span> <span class="nav-text">Loops</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Back-to-fix-command-line-potential-danger"><span class="nav-number">5.3.</span> <span class="nav-text">Back to fix command line potential danger</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Braces-in-Conditional-and-Loops"><span class="nav-number">5.4.</span> <span class="nav-text">Braces in Conditional and Loops</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Functions"><span class="nav-number">6.</span> <span class="nav-text">Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Function-Calls"><span class="nav-number">6.1.</span> <span class="nav-text">Function Calls</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Forward-Declarations"><span class="nav-number">6.2.</span> <span class="nav-text">Forward Declarations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Variable-Scope-and-Lifetime"><span class="nav-number">6.3.</span> <span class="nav-text">Variable Scope and Lifetime</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Custom-Types-and-Data-Structures-in-C"><span class="nav-number">7.</span> <span class="nav-text">Custom Types and Data Structures in C</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Custom-Types"><span class="nav-number">7.1.</span> <span class="nav-text">Custom Types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Custom-Data-Structures"><span class="nav-number">7.2.</span> <span class="nav-text">Custom Data Structures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration"><span class="nav-number">7.3.</span> <span class="nav-text">Enumeration</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction-to-Pointers"><span class="nav-number">8.</span> <span class="nav-text">Introduction to Pointers</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Program-Memory-Layout"><span class="nav-number">8.1.</span> <span class="nav-text">Program Memory Layout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pointers"><span class="nav-number">8.2.</span> <span class="nav-text">Pointers</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pointers-Applications"><span class="nav-number">9.</span> <span class="nav-text">Pointers Applications</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Allow-a-Function-to-Access-the-Calling-Context"><span class="nav-number">9.1.</span> <span class="nav-text">Allow a Function to Access the Calling Context</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Getting-over-C-FUnction-Call-Limitations"><span class="nav-number">9.2.</span> <span class="nav-text">Getting over C FUnction Call Limitations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-Arrarys-are-Pointers"><span class="nav-number">9.3.</span> <span class="nav-text">C Arrarys are Pointers!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pointers-and-Structures"><span class="nav-number">9.4.</span> <span class="nav-text">Pointers and Structures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pointer-Chains"><span class="nav-number">9.5.</span> <span class="nav-text">Pointer Chains</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Dynamic-Memory-Allocation"><span class="nav-number">10.</span> <span class="nav-text">Dynamic Memory Allocation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Motivation"><span class="nav-number">10.1.</span> <span class="nav-text">Motivation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Allocating-on-the-Heap-malloc"><span class="nav-number">10.2.</span> <span class="nav-text">Allocating on the Heap: malloc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multidimensional-Arrays-and-malloc"><span class="nav-number">10.3.</span> <span class="nav-text">Multidimensional Arrays and malloc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Memory-Leaks"><span class="nav-number">10.4.</span> <span class="nav-text">Memory Leaks</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-C-Standard-Library"><span class="nav-number">11.</span> <span class="nav-text">The C Standard Library</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#String-Copy"><span class="nav-number">11.1.</span> <span class="nav-text">String Copy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#String-Concatenation-%E8%BF%9E%E7%BB%93"><span class="nav-number">11.2.</span> <span class="nav-text">String Concatenation 连结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Format-based-String-Creation"><span class="nav-number">11.3.</span> <span class="nav-text">Format-based String Creation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#String-Manipulation"><span class="nav-number">11.4.</span> <span class="nav-text">String Manipulation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Console-Input"><span class="nav-number">11.5.</span> <span class="nav-text">Console Input</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Memory-Manipulation"><span class="nav-number">11.6.</span> <span class="nav-text">Memory Manipulation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Math-functions"><span class="nav-number">11.7.</span> <span class="nav-text">Math functions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Time"><span class="nav-number">11.8.</span> <span class="nav-text">Time</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#File-I-O"><span class="nav-number">11.9.</span> <span class="nav-text">File I&#x2F;O</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Random-Numbers"><span class="nav-number">11.10.</span> <span class="nav-text">Random Numbers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Error-Management"><span class="nav-number">11.11.</span> <span class="nav-text">Error Management</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Classes-and-Objects-in-C"><span class="nav-number">12.</span> <span class="nav-text">Classes and Objects in C++</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes-and-Objects"><span class="nav-number">12.1.</span> <span class="nav-text">Classes and Objects</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Encapsulation"><span class="nav-number">12.2.</span> <span class="nav-text">Encapsulation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Constructors"><span class="nav-number">12.3.</span> <span class="nav-text">Constructors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Destructors"><span class="nav-number">12.4.</span> <span class="nav-text">Destructors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#This-Pointer"><span class="nav-number">12.5.</span> <span class="nav-text">This Pointer</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C-Dynamic-Object-Allocation-and-Dynamic-Arrays"><span class="nav-number">13.</span> <span class="nav-text">C++: Dynamic Object Allocation and Dynamic Arrays</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Dynamic-Object-Allocation"><span class="nav-number">13.1.</span> <span class="nav-text">Dynamic Object Allocation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dynamic-Arrays"><span class="nav-number">13.2.</span> <span class="nav-text">Dynamic Arrays</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yangyang Cui"
      src="/uploads/selfie2.jpg">
  <p class="site-author-name" itemprop="name">Yangyang Cui</p>
  <div class="site-description" itemprop="description">share everything I want to share</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yangocean-sudo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangocean-sudo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/22/Programming-Languages-and-Paradigms-Part-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/selfie2.jpg">
      <meta itemprop="name" content="Yangyang Cui">
      <meta itemprop="description" content="share everything I want to share">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YangOcean">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Programming Languages and Paradigms -- Part 1
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-22 01:15:41" itemprop="dateCreated datePublished" datetime="2022-04-22T01:15:41+01:00">2022-04-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-04-27 22:17:09" itemprop="dateModified" datetime="2022-04-27T22:17:09+01:00">2022-04-27</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2022/04/22/Programming-Languages-and-Paradigms-Part-1/#SOHUCS" itemprop="discussionUrl">
        <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2022/04/22/Programming-Languages-and-Paradigms-Part-1/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>A programming paradigm is a fundamental style of programming used to classify programming languages.</p>
<a id="more"></a>
<h1 id="Main-Programming-Paradigms-and-Sub-Paradigms"><a href="#Main-Programming-Paradigms-and-Sub-Paradigms" class="headerlink" title="Main Programming Paradigms and Sub-Paradigms"></a>Main Programming Paradigms and Sub-Paradigms</h1><h2 id="Imperative"><a href="#Imperative" class="headerlink" title="Imperative"></a>Imperative</h2><ul>
<li><p><em>Structured</em> (or procedural)</p>
<ul>
<li>Eg. C</li>
</ul>
</li>
<li><p><em>Object Oriented</em></p>
<ul>
<li>Encapsulation of code and the associated data into objects</li>
<li>Suit to problems of huge amounts of state/operations <ul>
<li>GUI, simulators, video games, business management software</li>
</ul>
</li>
<li>Easy to organize large codebases</li>
<li>Eg. C#, C++, Java, Python</li>
</ul>
</li>
<li><p><em>Concurrent</em></p>
<ul>
<li>Shared-memory threads/processes in C/C++, Java, Python, etc.</li>
<li>Message passing (for example MPI) in C/C++/FORTRAN</li>
<li>Semi-automatic loop paralelization with libraries such as OpenMP</li>
<li>GPU programming with CUDA</li>
<li>Use cases: HPC, distributed computing, graphic processing, etc.</li>
</ul>
</li>
<li><p>Describes <em>sequences</em> of statements manipulating the program state</p>
<ul>
<li>describes how to obtain the computation results </li>
</ul>
</li>
<li><p>Uses advanced control flow operations</p>
<ul>
<li>Loops, conditionals, procedures</li>
<li>easier to describe/reason about complex/large programs</li>
</ul>
</li>
<li><p>Uses execution threads/processes to describe interleaving and/or parallel computation flows</p>
<ul>
<li>Example in C:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> *<span class="title">thread_function</span><span class="params">(<span class="keyword">void</span> *argument)</span> </span>&#123;     </span><br><span class="line">    <span class="keyword">int</span> id = *(<span class="keyword">int</span> *)argument;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Thread %d running on core %d\n&quot;</span>, id, sched_getcpu()); &#125; </span><br></pre></td></tr></table></figure>
<h2 id="Declarative"><a href="#Declarative" class="headerlink" title="Declarative"></a>Declarative</h2></li>
</ul>
</li>
<li><p><em>Functional</em></p>
<ul>
<li>First-class/higher-order functions </li>
<li>Loops implemented with recursion </li>
<li>Pure functions have no side-effects </li>
<li>Languages: Haskell, Scala, F#, etc.</li>
</ul>
</li>
<li><p><em>Concurrent</em></p>
<ul>
<li>Less need for synchronization</li>
<li>Use cases: distributed applications, web services, etc.</li>
</ul>
</li>
<li><p>Describes the <em>meaning/result</em> of computations</p>
</li>
<li><p>High level of abstraction Code can easily become convoluted </p>
</li>
<li><p>Languages: HTML, SQL, XML, CSS, Latex (non-Turing complete) </p>
</li>
<li><p>Usage: document rendering, structured data storage and manipulation</p>
</li>
<li><p>Calling and composing functions to describes the program </p>
</li>
</ul>
<h2 id="Multi-Paradigm-Languages"><a href="#Multi-Paradigm-Languages" class="headerlink" title="Multi-Paradigm Languages"></a>Multi-Paradigm Languages</h2><ul>
<li>Haskell: purely functional and does not allow OO style </li>
<li>OCaml: mainly functional, allows OO and imperative constructs </li>
<li>C, C++: imperative but allow some functional idoms:</li>
<li>Many languages are multi-paradigm</li>
</ul>
<h1 id="Introduction-to-C"><a href="#Introduction-to-C" class="headerlink" title="Introduction to C"></a>Introduction to C</h1><h2 id="Pros"><a href="#Pros" class="headerlink" title="Pros:"></a>Pros:</h2><ul>
<li>Syntax</li>
<li>Low level</li>
<li>Fast</li>
<li>Controlled memory footprint (occupation)控制内存占用<h2 id="Cons"><a href="#Cons" class="headerlink" title="Cons:"></a>Cons:</h2></li>
<li>Large area for making mistakes</li>
<li>Lack of memory safety, risks of undefined behavior at runtime<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; // to get access to functions from external libraries</span></span></span><br><span class="line"><span class="comment">// will run first when the program is executed</span></span><br><span class="line"><span class="comment">// returns an integer and takes no parameters</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// print text on the standard output</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello, world!\n&quot;</span>);</span><br><span class="line">    <span class="comment">// return to go back to the calling context, and exit if returning from main</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
Assuming the code is in listing1.c, to compile and run on the linux command line:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc listing1.c -o listing1</span><br><span class="line">.&#x2F;listing1</span><br><span class="line">hello, world! (This is the output)</span><br></pre></td></tr></table></figure>
<h1 id="C-–-Variables-Types-Printing-to-the-Console"><a href="#C-–-Variables-Types-Printing-to-the-Console" class="headerlink" title="C – Variables, Types, Printing to the Console"></a>C – Variables, Types, Printing to the Console</h1><h2 id="Variables"><a href="#Variables" class="headerlink" title="Variables:"></a>Variables:</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a;                  <span class="comment">// declare a of type int (signed integer)     </span></span><br><span class="line">    a = <span class="number">12</span>;                 <span class="comment">// set the value of a to 12     </span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a: %d\n&quot;</span>, a);   <span class="comment">// print the value of a</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Variable:name,type,value</li>
<li>Must be <em>declared</em> before being used<ul>
<li>Declare with &lt;variable type&gt;&lt;variable name&gt;</li>
</ul>
</li>
<li>A variable’s name should start with a letter or underscore<ul>
<li>It can contain a combination of letters/numbers/underscores<ul>
<li>E.g: int _x; int sum; int combination_int3;<h2 id="Types"><a href="#Types" class="headerlink" title="Types:"></a>Types:</h2></li>
</ul>
</li>
</ul>
</li>
<li>Defines the amount of space in memory allocated to the variable </li>
<li>Compiler checks the validty of operations on the variable at build time</li>
<li>3 basic types categories: integers, floating-point numbers, characters<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// INTEGER</span></span><br><span class="line"><span class="keyword">int</span> a; <span class="comment">// signed integer takes 4 bytes in memory on the Intel x86-64 architecture</span></span><br><span class="line"><span class="comment">// CHARACTERS</span></span><br><span class="line"><span class="keyword">char</span> my_char_variable;</span><br><span class="line">my_char_variable = <span class="string">&#x27;x&#x27;</span>; <span class="comment">// using single quotes for characters</span></span><br><span class="line"><span class="comment">// FLOATS</span></span><br><span class="line"><span class="keyword">float</span> my_float_var;</span><br><span class="line">my_float_var = <span class="number">12.4</span>;</span><br><span class="line"><span class="comment">// MIXING INTEGERS AND FLOATS</span></span><br><span class="line"><span class="keyword">int</span> int1 = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">float</span> float1 = <span class="number">3.8</span>;</span><br><span class="line"><span class="keyword">int</span> int2 = int1 + float1; <span class="comment">// int2 = 5;</span></span><br><span class="line"><span class="keyword">int</span> int3 = int1 * float1; <span class="comment">// int3 = 7;</span></span><br><span class="line"><span class="comment">/* when mixed with floats in arithmetics, integers are promoted to floats */</span> </span><br><span class="line"><span class="comment">/* when stored in an integer variable, floats are _truncated_ */</span> </span><br></pre></td></tr></table></figure></li>
<li>Types and Qualifiers<ul>
<li>Types: char, int, float, double<ul>
<li>The function <code>sizeof</code> can be used to get the exact size of a type on a given manchine<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> so_short = <span class="keyword">sizeof</span>(<span class="keyword">short</span> <span class="keyword">int</span>);     </span><br><span class="line"><span class="keyword">int</span> so_int = <span class="keyword">sizeof</span>(<span class="keyword">int</span>); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;size of short:%d bytes\n&quot;</span>, so_short); </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Qualifers: signed, unsigned(positive), short, long</li>
<li>Determines the storage size in memory</li>
<li>Exact implementation is architecture dependent 依赖于架构<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">short</span> <span class="keyword">int</span> a;              <span class="comment">// signed, at least 16 bits: [−32,767,        +32,767] i</span></span><br><span class="line"><span class="keyword">int</span> b;                    <span class="comment">// signed, at least 16 bits: [−32,767,        +32,767] </span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> c;           <span class="comment">// unsigned:                 [0,              +65,535] </span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">int</span> d;               <span class="comment">// at least 32 bits:         [−2,147,483,647, +2,147,483,647] </span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> e;      <span class="comment">// unsigned:                 [0,              +4,294,967,295] </span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> f;          <span class="comment">// at least 64 bits:         [-9x10^18,       +9x10^18] </span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> g; <span class="comment">// unsigned:                 [0,              +18x10^18] </span></span><br><span class="line"><span class="keyword">float</span> h;                  <span class="comment">// storage size unspecified, generally 32 bits </span></span><br><span class="line"><span class="keyword">double</span> i;                 <span class="comment">// storage size unspecified, generally 64 bits</span></span><br></pre></td></tr></table></figure>
<h2 id="Printing-to-the-Console-printf"><a href="#Printing-to-the-Console-printf" class="headerlink" title="Printing to the Console: printf"></a>Printing to the Console: printf</h2></li>
</ul>
</li>
<li>Accepts one or more arguments: format string + variable list<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> int_var = <span class="number">-1</span>; </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> uint_var = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">int</span> lint_var = <span class="number">10</span>; </span><br><span class="line"><span class="keyword">float</span> float_var = <span class="number">2.5</span>; </span><br><span class="line"><span class="keyword">double</span> double_var = <span class="number">2.5</span>; </span><br><span class="line"><span class="keyword">char</span> char_var = <span class="string">&#x27;a&#x27;</span>; </span><br><span class="line"><span class="keyword">char</span> string_var[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Integer: %d\n&quot;</span>, int_var);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Unsigned integer: %u\n&quot;</span>, uint_var);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Long integer: %ld\n&quot;</span>, lint_var);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Float: %f\n&quot;</span>, float_var); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Double: %lf\n&quot;</span>, double_var); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Characters: %c\n&quot;</span>, char_var); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;String: %s\n&quot;</span>, string_var);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Several variables: %d, %lf, %s\n&quot;</span>,     int_var, double_var, string_var); </span><br><span class="line"><span class="comment">// Format string accepts escaped character such as \n for line break</span></span><br></pre></td></tr></table></figure></li>
<li>Make sure to use the right marker because the compiler won’t tell you the mistakes and incorrect values<ul>
<li>It will show warning like:”format ‘%u’ expects argument of type ‘unsigned int’, but argument 2 has type ‘long long unsigned int’ “<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> my_variable = <span class="number">-42</span>; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-42 printed with %%d: %d\n&quot;</span>, my_variable); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-42 printed with %%u: %u\n&quot;</span>, my_variable);  <span class="comment">// -42 interpreted as an unsigned integer</span></span><br><span class="line"><span class="comment">// The outcome is 4294967254</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> ull = <span class="number">5467513055454315</span>; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ull printed with %%llu: %llu\n&quot;</span>, ull); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ull printed with %%u: %u\n&quot;</span>, ull); <span class="comment">// interprets only 4 bytes vs. 8 for llu</span></span><br><span class="line"><span class="comment">// The outcome is 2507777131</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ull printed with %%d: %d\n&quot;</span>, ull); <span class="comment">// first 4 bytes, interpreted as unsigned </span></span><br><span class="line"><span class="comment">// The outcome is -1787190165</span></span><br></pre></td></tr></table></figure>
<h1 id="Arrays-Strings-Command-Line-Arguments"><a href="#Arrays-Strings-Command-Line-Arguments" class="headerlink" title="Arrays, Strings, Command Line Arguments"></a>Arrays, Strings, Command Line Arguments</h1><h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">4</span>];     <span class="comment">// declaration </span></span><br><span class="line"><span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">10</span>;    <span class="comment">// write a slot </span></span><br><span class="line"><span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">20</span>; </span><br><span class="line"><span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">30</span>; </span><br><span class="line"><span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">40</span>;</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">array</span>[<span class="number">3</span>];  <span class="comment">// read a slot</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;array[%d] contains %d\n&quot;</span>, <span class="number">0</span>, <span class="built_in">array</span>[<span class="number">0</span>]); <span class="comment">//array[0] contains 10</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;array[%d] contains %d\n&quot;</span>, <span class="number">1</span>, <span class="built_in">array</span>[<span class="number">1</span>]); <span class="comment">//array[1] contains 20</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;array[%d] contains %d\n&quot;</span>, <span class="number">2</span>, <span class="built_in">array</span>[<span class="number">2</span>]); <span class="comment">//array[2] contains 30</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Arrays are stored <em>contiguously</em> in memory;</li>
<li>Multi-Dimensional Arrays<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> my_2d_array[<span class="number">3</span>][<span class="number">2</span>]; </span><br><span class="line">my_2d_array[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>; </span><br></pre></td></tr></table></figure></li>
<li>Static initialization allows to omit the size (of the first dimension)<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="built_in">array</span>[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;; <span class="comment">// do not have the size </span></span><br><span class="line"><span class="keyword">int</span> array_2d[][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>, <span class="number">2</span>&#125;, &#123;<span class="number">3</span>, <span class="number">4</span>&#125;, &#123;<span class="number">5</span>, <span class="number">6</span>&#125;&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Character arrays, i.e. Strings<ul>
<li>String: array of characters that ends with the special <code>\0</code> end of string character marker<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> string1[<span class="number">6</span>] = <span class="string">&quot;hello&quot;</span>; </span><br><span class="line"><span class="keyword">char</span> string2[] = <span class="string">&quot;hello&quot;</span>; </span><br><span class="line"><span class="keyword">char</span> string3[<span class="number">6</span>];</span><br><span class="line">string3[<span class="number">0</span>] = <span class="string">&#x27;h&#x27;</span>;     </span><br><span class="line">string3[<span class="number">1</span>] = <span class="string">&#x27;e&#x27;</span>;     </span><br><span class="line">string3[<span class="number">2</span>] = <span class="string">&#x27;l&#x27;</span>;     </span><br><span class="line">string3[<span class="number">3</span>] = <span class="string">&#x27;l&#x27;</span>;     </span><br><span class="line">string3[<span class="number">4</span>] = <span class="string">&#x27;o&#x27;</span>;     </span><br><span class="line">string3[<span class="number">5</span>] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// Important here</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, string1); <span class="comment">// hello</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, string2); <span class="comment">// hello</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, string3); <span class="comment">// hello</span></span><br></pre></td></tr></table></figure>
<h2 id="Command-Line-Arguments"><a href="#Command-Line-Arguments" class="headerlink" title="Command Line Arguments"></a>Command Line Arguments</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc test.c -o program</span><br></pre></td></tr></table></figure>
gcc is program; the rest are arguments</li>
</ul>
</li>
<li><code>main</code> parameters:<ul>
<li>argc (integer)</li>
<li>argv: array containing the command line arguments</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123; <span class="comment">// &#x27;char ** argv&#x27; means &#x27;char argv[][]&#x27;     </span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Number of command line arguments: %d\n&quot;</span>, argc);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// This is a bit dangerous...     </span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;argument 0: %s\n&quot;</span>, argv[<span class="number">0</span>]);     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;argument 1: %s\n&quot;</span>, argv[<span class="number">1</span>]);     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;argument 2: %s\n&quot;</span>, argv[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>If the command line input is: <code>./test one two three</code></li>
</ul>
<p>The output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Number of command line arguments: 4</span><br><span class="line">argument 0: .&#x2F;test</span><br><span class="line">argument 1: one</span><br><span class="line">argument 2: two</span><br></pre></td></tr></table></figure>
<ul>
<li>If the command line input is: <code>./test one</code></li>
</ul>
<p>The output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Number of command line arguments: 2</span><br><span class="line">argument 0: .&#x2F;test</span><br><span class="line">argument 1: one</span><br><span class="line">argument 2: (null)</span><br></pre></td></tr></table></figure>
<ul>
<li>If the command line input is: <code>./test</code></li>
</ul>
<p>The output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Number of command line arguments: 1</span><br><span class="line">argument 0: .&#x2F;test</span><br><span class="line">argument 1: (null)</span><br><span class="line">argument 2: LC_ALL&#x3D;C.UTF-8</span><br></pre></td></tr></table></figure>
<p>This is quite DANGEROUS</p>
<ul>
<li>Arguments are strings, to convert to integer use <code>atoi</code>:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; // needed for atoi </span></span></span><br><span class="line"><span class="comment">/* Sum the two integers passed as command line integers */</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">int</span> a, b;     </span><br><span class="line">  <span class="comment">// Once again, dangerous!    </span></span><br><span class="line">  a = atoi(argv[<span class="number">1</span>]);     </span><br><span class="line">  b = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d + %d = %d\n&quot;</span>, a, b, a+b);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>To convert to integer use <code>atof</code><h1 id="Conditionals-and-Loops-in-C"><a href="#Conditionals-and-Loops-in-C" class="headerlink" title="Conditionals and Loops in C"></a>Conditionals and Loops in C</h1></li>
</ul>
</li>
<li>Statements end with <code>;</code> and are executed sequentially<h2 id="Conditionals"><a href="#Conditionals" class="headerlink" title="Conditionals"></a>Conditionals</h2></li>
<li>Condition: <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>，<code>!=</code></li>
<li>“false” is <code>0</code>, “true” is everything except <code>0</code></li>
<li>Boolean operations:<code>&amp;&amp;</code> AND, <code>||</code> OR, <code>!</code> negation<ul>
<li>Operators precedence优先级: <code>!</code>first, then<code>&amp;&amp;</code>, the<code>||</code></li>
<li>Use parentheses to modify/clarify evaluation order</li>
</ul>
</li>
<li>Switch statement<ul>
<li>Test the equality of an integer against a list of values</li>
<li>Use <code>break</code> to avoid fallthrough坠落 in cases</li>
<li><code>default</code> path taken when none of the other cases matches<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(x) &#123;     </span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>:         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x is 1\n&quot;</span>);         </span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>:         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x is 2\n&quot;</span>);         </span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span>:         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x is 3\n&quot;</span>);         </span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x is neither 1, nor 2, nor 3\n&quot;</span>); &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Loops"><a href="#Loops" class="headerlink" title="Loops"></a>Loops</h2></li>
</ul>
</li>
<li>While loop<ul>
<li><code>while...</code> checks the condition before entering the loop body</li>
<li><code>do... while</code> checks after a first iternation</li>
</ul>
</li>
<li>For Loops<ul>
<li>for (&lt;init statement&gt; ; &lt;condition&gt;; &lt;update statement&gt;) {&lt;body&gt;}<ul>
<li>&lt;init statement&gt; executed once before the first iteration</li>
<li>&lt;condition&gt; checked before each iteration</li>
<li>&lt;update statement&gt; executed after each iteration</li>
<li>E.g <code>for(int i = 0; i&lt;10; i = i + 1) &#123;...&#125;</code></li>
</ul>
</li>
<li><code>break</code> simply exits the loop</li>
<li><code>continue</code> directly goes to the next iteration<h2 id="Back-to-fix-command-line-potential-danger"><a href="#Back-to-fix-command-line-potential-danger" class="headerlink" title="Back to fix command line potential danger"></a>Back to fix command line potential danger</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print_help_and_exit</span><span class="params">(<span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s &lt;number 1&gt; &lt;number 2&gt;\n&quot;</span>, argv[<span class="number">0</span>]);     </span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">-1</span>); &#125; </span><br><span class="line">  <span class="comment">/* Sum the two integers passed as command line integers */</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">int</span> a, b;</span><br><span class="line">  <span class="comment">// To make sure there are only two numbers in command line</span></span><br><span class="line">  <span class="keyword">if</span>(argc != <span class="number">3</span>)         </span><br><span class="line">    print_help_and_exit(argv);     </span><br><span class="line">  a = atoi(argv[<span class="number">1</span>]);     </span><br><span class="line">  b = atoi(argv[<span class="number">2</span>]);     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d + %d = %d\n&quot;</span>, a, b, a+b);     </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Braces-in-Conditional-and-Loops"><a href="#Braces-in-Conditional-and-Loops" class="headerlink" title="Braces in Conditional and Loops"></a>Braces in Conditional and Loops</h2></li>
</ul>
</li>
<li>Can omit(ignore) the braces if conditional/loop body is a single statement<h1 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h1></li>
<li>Contains <em>name</em>, zero or more <em>parameters</em> with <em>types</em>, and a <em>return type</em><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add_two_integers</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">int</span> result = a + b;     </span><br><span class="line">  <span class="keyword">return</span> result; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>The absence缺席 of return value can be indicated with the <code>void</code> type<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_hello</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;hello!\n&quot;</span>);     </span><br><span class="line">  <span class="keyword">return</span>; <span class="comment">// we can even omit this as the function does not return anything &#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Function-Calls"><a href="#Function-Calls" class="headerlink" title="Function Calls"></a>Function Calls</h2></li>
<li>Function parameters and return value are passed as copies<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_function</span><span class="params">(<span class="keyword">int</span> parameter)</span> </span>&#123;     </span><br><span class="line">    parameter = <span class="number">12</span>; <span class="comment">// does not update x in main </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;     </span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">10</span>;     </span><br><span class="line">    my_function(x);     </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x is %d\n&quot;</span>, x); <span class="comment">// x is 10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Forward-Declarations"><a href="#Forward-Declarations" class="headerlink" title="Forward Declarations"></a>Forward Declarations</h2></li>
<li>Forward declaration, also called function _prototype_ 原型</li>
<li>The compiler parses解析 source files from top to bottom<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  ....</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* The actual function definition */</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">return</span> a + b; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Variable-Scope-and-Lifetime"><a href="#Variable-Scope-and-Lifetime" class="headerlink" title="Variable Scope and Lifetime"></a>Variable Scope and Lifetime</h2></li>
<li>Global variables declared outside functions<ul>
<li>visible at the level of the entire source file</li>
</ul>
</li>
<li>Try to <em>limit</em> the use of globals as much as possible<ul>
<li>A lot of global state makes it harder to reason about the program</li>
</ul>
</li>
<li>Within a a function, a declared local variable is accesible within its enclosing braces (a block of code)<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> j; </span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">10</span>; j++) &#123; </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;In loop body, j is %d\n&quot;</span>, j); </span><br><span class="line">&#125;   </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Out of loop body, j is %d\n&quot;</span>, j); <span class="comment">// Out of loop body, j is 10</span></span><br></pre></td></tr></table></figure>
<h1 id="Custom-Types-and-Data-Structures-in-C"><a href="#Custom-Types-and-Data-Structures-in-C" class="headerlink" title="Custom Types and Data Structures in C"></a>Custom Types and Data Structures in C</h1><h2 id="Custom-Types"><a href="#Custom-Types" class="headerlink" title="Custom Types"></a>Custom Types</h2></li>
<li>Use <code>typedef</code> to alias别名 a type<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="comment">// &#x27;my_int&#x27; is now equivalent to &#x27;long long unsigned int&#x27; </span></span><br><span class="line"><span class="comment">// To make it shorter</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> my_int;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  my_int x = <span class="number">12</span>;     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;x is: %llu\n&quot;</span>, x);    </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Custom-Data-Structures"><a href="#Custom-Data-Structures" class="headerlink" title="Custom Data Structures"></a>Custom Data Structures</h2></li>
<li>Use struct to define a data structure with named fields </li>
<li>Use struct &lt;struct name&gt; to refer to it as a type </li>
<li>Access the fields of a variable with &lt;variable_name&gt;.&lt;field_name&gt;<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; // needed for strcpy (string copy)</span></span></span><br><span class="line"><span class="comment">// Definition of the struct: </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span>     </span><br><span class="line">  <span class="keyword">char</span> name[<span class="number">10</span>];     </span><br><span class="line">  <span class="keyword">float</span> size_in_meters;     </span><br><span class="line">  <span class="keyword">int</span> weight_in_grams; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_person</span><span class="params">(struct person p)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* Access fields with &#x27;.&#x27; */</span>     </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s has a size of %f meters and weights %d grams\n&quot;</span>, p.name, p.size_in_meters, p.weight_in_grams); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="comment">// declare a variable of the struct type:     </span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">person</span> <span class="title">p1</span>;</span>     </span><br><span class="line">  <span class="comment">// sets the variable field     </span></span><br><span class="line">  p1.size_in_meters = <span class="number">1.6</span>;     </span><br><span class="line">  p1.weight_in_grams = <span class="number">60000</span>;     </span><br><span class="line">  <span class="built_in">strcpy</span>(p1.name, <span class="string">&quot;Julie&quot;</span>);</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">person</span> <span class="title">p2</span> =</span> &#123;<span class="string">&quot;George&quot;</span>, <span class="number">1.8</span>, <span class="number">70000</span>&#125;;     </span><br><span class="line">  print_person(p1);     </span><br><span class="line">  print_person(p2);     </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Fields are place consecutively连续地 in memory (compiler may insert padding)</li>
<li>Structures can be <code>typedef</code><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; // needed for strcpy</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">s_person</span> &#123;</span>     </span><br><span class="line">  <span class="comment">/* fields declaration ... */</span> </span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">s_person</span> <span class="title">person</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_person</span><span class="params">(person p)</span> </span>&#123; <span class="comment">/* ... */</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  person p1;     </span><br><span class="line">  person p2 = &#123;<span class="string">&quot;George&quot;</span>, <span class="number">1.8</span>, <span class="number">70000</span>&#125;;     </span><br><span class="line">  <span class="comment">/* ... */</span> &#125;</span><br></pre></td></tr></table></figure>
A faster way to define structures:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="comment">/* fields declaration ... */</span></span><br><span class="line">&#125; person;</span><br></pre></td></tr></table></figure>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2></li>
<li>User defined type for assigning textual names to integer constants</li>
<li>The compiler assigns an <em>integer constant</em> to each value of an enum<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">color</span>&#123;</span></span><br><span class="line">  RED,</span><br><span class="line">  BLUE,</span><br><span class="line">  GREEN</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Enumerations can be <code>typedef</code>‘d</li>
</ul>
<p><code>typedef enum color mycolor</code></p>
<p>or in once:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span>     </span><br><span class="line">  BLUE,     </span><br><span class="line">  <span class="comment">/* ... */</span> </span><br><span class="line">&#125; color;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Introduction-to-Pointers"><a href="#Introduction-to-Pointers" class="headerlink" title="Introduction to Pointers"></a>Introduction to Pointers</h1><h2 id="Program-Memory-Layout"><a href="#Program-Memory-Layout" class="headerlink" title="Program Memory Layout"></a>Program Memory Layout</h2><ul>
<li>All the program’s code and data is present somewhere in memory </li>
<li>The area of memory accessible by the program is the <em>address space</em><ul>
<li>Large array of contiguous bytes</li>
<li>Addresses are indexes in that array</li>
</ul>
</li>
<li>This is <em>Virtual</em> memory:<ul>
<li>Address space size independent from the amount of RAM</li>
<li>Each program gets its own address space</li>
</ul>
</li>
<li><em>Address of a variable:</em> the address in memory of the first byte storing that variable</li>
<li>Use the <code>&amp;</code> operator to get the address of a variable</li>
<li>With modern processeors an address is a 64 bit value so we need the right format specifier: ‘%lu’ or ‘%lx’ if we want to print in hexadecimal<h2 id="Pointers"><a href="#Pointers" class="headerlink" title="Pointers"></a>Pointers</h2></li>
<li>Pointer: variable that contains an address(possibly of another variable)<ul>
<li>Declaration: &lt;pointed type&gt; * &lt;pointer name&gt;<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> v = <span class="number">42</span>; </span><br><span class="line"><span class="keyword">int</span> *ptr = &amp;v;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Access the pointed value with <code>*</code><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;pointer value:   0x%lx\n&quot;</span>, ptr);  <span class="comment">// 0xF123</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;pointed value:   %d\n&quot;</span>, *ptr);    <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<h1 id="Pointers-Applications"><a href="#Pointers-Applications" class="headerlink" title="Pointers Applications"></a>Pointers Applications</h1><h2 id="Allow-a-Function-to-Access-the-Calling-Context"><a href="#Allow-a-Function-to-Access-the-Calling-Context" class="headerlink" title="Allow a Function to Access the Calling Context"></a>Allow a Function to Access the Calling Context</h2></li>
<li>Can’t change a fuction’s parameter unless to use pointer<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_one</span><span class="params">(<span class="keyword">int</span> *param)</span> </span>&#123;</span><br><span class="line">  *param++;  <span class="comment">// access the pointed value</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">int</span> x = <span class="number">20</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;before call, x is %d\n&quot;</span>, x);   <span class="comment">// print 20     </span></span><br><span class="line">  add_one(&amp;x);     <span class="comment">// address of x</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;after call, x is %d\n&quot;</span>, x);    <span class="comment">// print 21</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>A function can ‘return’ more than a single value if…<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// we want this function to return 3 things: the product and quotient of n1 by n2, </span></span><br><span class="line"><span class="comment">// as well as an error code in case division is impossible </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply_and_divide</span><span class="params">(<span class="keyword">int</span> n1, <span class="keyword">int</span> n2, <span class="keyword">int</span> *product, <span class="keyword">int</span> *quotient)</span> </span>&#123;     </span><br><span class="line">  <span class="comment">/* Can&#x27;t divide if n2 is 0 */</span>     </span><br><span class="line">  <span class="keyword">if</span>(n2 == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  *product = n1 * n2;     </span><br><span class="line">  *quotient = n1 / n2;     </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;     </span><br><span class="line">  <span class="keyword">int</span> p, q, a = <span class="number">10</span>, b = <span class="number">5</span>;     </span><br><span class="line">  <span class="keyword">if</span>(multiply_and_divide(a, b, &amp;p, &amp;q) == <span class="number">0</span>) &#123;         </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;10*5 = %d\n&quot;</span>, p); <span class="comment">// 10*5 = 50</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;10/5 = %d\n&quot;</span>, q); <span class="comment">// 10/5 = 2     </span></span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Getting-over-C-FUnction-Call-Limitations"><a href="#Getting-over-C-FUnction-Call-Limitations" class="headerlink" title="Getting over C FUnction Call Limitations"></a>Getting over C FUnction Call Limitations</h2></li>
<li>Assume we want to write a function updating a large struct variable<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="comment">// lots of large (8 bytes) fields:</span></span><br><span class="line">    <span class="keyword">double</span> a; <span class="keyword">double</span> b; <span class="keyword">double</span> c; <span class="keyword">double</span> d; <span class="keyword">double</span> e; <span class="keyword">double</span> f;</span><br><span class="line">&#125; large_struct;</span><br><span class="line"></span><br><span class="line"><span class="function">large_struct <span class="title">f</span><span class="params">(large_struct s)</span> </span>&#123; <span class="comment">// very inefficient in terms of performance and memory usage!</span></span><br><span class="line">    s.a += <span class="number">42.0</span>;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;<span class="comment">//set a large struct and only change one variable in it</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    large_struct x = &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">6.0</span>&#125;;</span><br><span class="line">    large_struct y = f(x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;y.a: %f\n&quot;</span>, y.a); <span class="comment">// 43.0000</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Huge performance loss and memory footprint increase!</li>
<li>Solution: With pointer: maintain a single copy of the variable<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span> </span><br><span class="line">  <span class="keyword">double</span> a; <span class="keyword">double</span> b; <span class="keyword">double</span> c; <span class="keyword">double</span> d; <span class="keyword">double</span> e; <span class="keyword">double</span> f;</span><br><span class="line">&#125; large_struct;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(large_struct *s)</span> </span>&#123;  <span class="comment">// now takes a pointer parameter</span></span><br><span class="line">    (*s).a += <span class="number">42.0</span>;         <span class="comment">// dereference to access x</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    large_struct x = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    f(&amp;x);                 <span class="comment">// pass x&#x27;s address</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x.a: %f\n&quot;</span>, x.a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
This is much faster and efficient<h2 id="C-Arrarys-are-Pointers"><a href="#C-Arrarys-are-Pointers" class="headerlink" title="C Arrarys are Pointers!"></a>C Arrarys are Pointers!</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">negate_int_array</span><span class="params">(<span class="keyword">int</span> *ptr, <span class="keyword">int</span> size)</span> </span>&#123; <span class="comment">// functions taking arrays as parameters</span></span><br><span class="line">  <span class="comment">// also need the size to iterate properly</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++)     </span><br><span class="line">  <span class="comment">// use square brackets like a standard array</span></span><br><span class="line">    ptr[i] = -ptr[i];      </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">array</span>[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;;</span><br><span class="line">    negate_int_array(<span class="built_in">array</span>, <span class="number">7</span>); <span class="comment">// to get the pointer just use the array&#x27;s name</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">7</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;array[%d] = %d\n&quot;</span>, i, <span class="built_in">array</span>[i]); <span class="comment">// the result will be negative</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>We can call the elemnt in array by using *(arrayname + index)<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> int_array[<span class="number">2</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">double</span> double_array[<span class="number">2</span>] = &#123;<span class="number">4.2</span>, <span class="number">2.4</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> char_array[] = <span class="string">&quot;ab&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;int_array[0]      = %d\n&quot;</span>, int_array[<span class="number">0</span>]); <span class="comment">//=1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;int_array[1]      = %d\n&quot;</span>, int_array[<span class="number">1</span>]); <span class="comment">//=2</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(int_array+0)    = %d\n&quot;</span>, *(int_array+<span class="number">0</span>)); <span class="comment">// pointer arithmetic!, =1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(int_array+1)    = %d\n&quot;</span>, *(int_array+<span class="number">1</span>)); <span class="comment">// +1 means + sizeof(array type), =2</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;double_array[0]   = %f\n&quot;</span>, double_array[<span class="number">0</span>]); <span class="comment">//=4.200</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;double_array[1]   = %f\n&quot;</span>, double_array[<span class="number">1</span>]); <span class="comment">//=2.400</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(double_array+0) = %f\n&quot;</span>, *(double_array+<span class="number">0</span>));<span class="comment">//=4.200</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(double_array+1) = %f\n&quot;</span>, *(double_array+<span class="number">1</span>));<span class="comment">//=2.400</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;char_array[0]     = %c\n&quot;</span>, char_array[<span class="number">0</span>]);    <span class="comment">//=a</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;char_array[1]     = %c\n&quot;</span>, char_array[<span class="number">1</span>]);    <span class="comment">//=b</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(char_array+0)   = %c\n&quot;</span>, *(char_array+<span class="number">0</span>));  <span class="comment">//=a</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;*(char_array+1)   = %c\n&quot;</span>, *(char_array+<span class="number">1</span>));  <span class="comment">//=b</span></span><br></pre></td></tr></table></figure>
<h2 id="Pointers-and-Structures"><a href="#Pointers-and-Structures" class="headerlink" title="Pointers and Structures"></a>Pointers and Structures</h2></li>
<li>. takes precedence优先级 over *</li>
<li>s-&gt;x is a shortcut for (*s).x<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> int_member1;</span><br><span class="line">    <span class="keyword">int</span> int_member2;</span><br><span class="line">    <span class="keyword">int</span> *ptr_member;</span><br><span class="line">&#125; my_struct;</span><br><span class="line"><span class="comment">/* declare and initialise ms of type my_struct ... */</span></span><br><span class="line">my_struct *p = &amp;ms;</span><br><span class="line">(*p).int_member1 = <span class="number">1</span>; <span class="comment">// don&#x27;t forget the parentheses! . takes precedence over *</span></span><br><span class="line">p-&gt;int_member2 = <span class="number">2</span>;   <span class="comment">// s-&gt;x is a shortcut for (*s).x</span></span><br><span class="line">p-&gt;ptr_member = &amp;(p-&gt;int_member2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p-&gt;int_member1 = %d\n&quot;</span>, p-&gt;int_member1); <span class="comment">//1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p-&gt;int_member2 = %d\n&quot;</span>, p-&gt;int_member2); <span class="comment">//2</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p-&gt;ptr_member = %p\n&quot;</span>, p-&gt;ptr_member);   <span class="comment">//0x7fff38692954</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;*(p-&gt;ptr_member) = %d\n&quot;</span>, *(p-&gt;ptr_member)); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
p-&gt;int_member2 is (*p).int_member2 = 2; &amp;(p-&gt;int_member2) is the address of this variable; *(p-&gt;ptr_member) is the actual value of this address point at<h2 id="Pointer-Chains"><a href="#Pointer-Chains" class="headerlink" title="Pointer Chains"></a>Pointer Chains</h2></li>
<li>A pointer is a variable and has itself an address, i.e. a location in memory, so it can be pointed to!<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> value = <span class="number">42</span>;         <span class="comment">// integer</span></span><br><span class="line"><span class="keyword">int</span> *ptr1 = &amp;value;     <span class="comment">// pointer of integer</span></span><br><span class="line"><span class="keyword">int</span> **ptr2 = &amp;ptr1;     <span class="comment">// pointer of pointer of integer</span></span><br><span class="line"><span class="keyword">int</span> ***ptr3 = &amp;ptr2;    <span class="comment">// pointer of pointer of pointer of integer</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ptr1: %p, *ptr1: %d\n&quot;</span>, ptr1, *ptr1);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ptr2: %p, *ptr2: %p, **ptr2: %d\n&quot;</span>, ptr2, *ptr2, **ptr2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ptr3: %p, *ptr3: %p, **ptr3: %p, ***ptr3: %d\n&quot;</span>, ptr3, *ptr3, **ptr3, ***ptr3);</span><br></pre></td></tr></table></figure>
The output is:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ptr1: 0x7ffc7e51775c, *ptr1: 42</span><br><span class="line">ptr2: 0x7ffc7e517760, *ptr2: 0x7ffc7e51775c, **ptr2: 42</span><br><span class="line">ptr3: 0x7ffc7e517768, *ptr3: 0x7ffc7e517760, **ptr3: 0x7ffc7e51775c, ***ptr3: 42</span><br></pre></td></tr></table></figure>
<h1 id="Dynamic-Memory-Allocation"><a href="#Dynamic-Memory-Allocation" class="headerlink" title="Dynamic Memory Allocation"></a>Dynamic Memory Allocation</h1><h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2></li>
<li>Many scenarios where an array size is determined only at runtime</li>
<li>Variable size arrays are rarely used due to support and space restrictions<ul>
<li>Are not supported for all versions of C, if we try a very large number, we will get an error “segmentation fault”</li>
</ul>
</li>
<li>So we need another solution</li>
<li>Static data: large size, all allocations fixed at compile time. Store <em>global variables</em> </li>
<li>Stack: small size, most allocations fixed at compile time.</li>
<li>Heap: lagre size, all allocations made dynamically at runtime<h2 id="Allocating-on-the-Heap-malloc"><a href="#Allocating-on-the-Heap-malloc" class="headerlink" title="Allocating on the Heap: malloc"></a>Allocating on the Heap: <code>malloc</code></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; // needed for malloc</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">process_array</span><span class="params">(<span class="keyword">int</span> *<span class="built_in">array</span>, <span class="keyword">int</span> size)</span> </span>&#123; <span class="comment">/* do something with array */</span> &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *heap_array;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">  <span class="keyword">int</span> size = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">  heap_array = <span class="built_in">malloc</span>(size * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">  <span class="keyword">if</span>(heap_array == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  process_array(heap_array, size);</span><br><span class="line">  <span class="built_in">free</span>(heap_array); <span class="comment">//free up memory when you done with it</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><code>malloc</code> allocates a chunk of memory on the heap and returns a pointer to it<ul>
<li>Memory is contiguous and can be used as an array</li>
</ul>
</li>
<li>Returns NULL (0) if the allocation fails<ul>
<li><em>Always check the return value</em></li>
</ul>
</li>
<li><code>void *</code>: generic pointer type<ul>
<li>Void pointer is a specific pointer type – void * – a pointer that points to some data location in storage, which doesn’t have any specific type. Void refers to the type. Basically the type of data that it points to is can be any. If we assign address of char data type to void pointer it will become char Pointer, if int data type then int pointer and so on. <a target="_blank" rel="noopener" href="https://www.atnyla.com/tutorial/void-generic-pointers/1/371#:~:text=When%20a%20variable%20is%20declared,another%20kind%20of%20pointer%20first.">Citation</a></li>
</ul>
</li>
<li><code>size_t</code>: long unsigned int<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">malloc</span><span class="params">(<span class="keyword">size_t</span> size)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">(<span class="keyword">void</span> *ptr)</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="Multidimensional-Arrays-and-malloc"><a href="#Multidimensional-Arrays-and-malloc" class="headerlink" title="Multidimensional Arrays and malloc"></a>Multidimensional Arrays and malloc</h2></li>
<li>3 x 2 int array<br><img src="https://olivierpierre.github.io/comp26020/slides/11-dynamic-memory-allocation/include/2d-3.svg" alt="double array in heap and stack"></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">3</span>; <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> **<span class="built_in">array</span>; </span><br><span class="line"><span class="built_in">array</span> = <span class="built_in">malloc</span>(a * <span class="keyword">sizeof</span>(<span class="keyword">int</span> *)); <span class="comment">// return the pointer of 1d array pointers</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;a; i++) &#123;</span><br><span class="line">    <span class="built_in">array</span>[i] = <span class="built_in">malloc</span>(b * <span class="keyword">sizeof</span>(<span class="keyword">int</span>)); <span class="comment">//return the pointer of numbers </span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">array</span>[i] == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">array</span>[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">12</span>;</span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;a; i++)</span><br><span class="line">    <span class="built_in">free</span>(<span class="built_in">array</span>[i]);</span><br><span class="line"><span class="built_in">free</span>(<span class="built_in">array</span>);</span><br></pre></td></tr></table></figure>
<h2 id="Memory-Leaks"><a href="#Memory-Leaks" class="headerlink" title="Memory Leaks"></a>Memory Leaks</h2><ul>
<li>Don’t forget to free memory!<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_ten_integers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *<span class="built_in">array</span> = <span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">array</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;cannot allocate memory ...\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">array</span>[i] = rand()%<span class="number">100</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="comment">/* array is neve free, leaking 10*sizeof(int) of memory each iteration */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> iterations = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;iterations; i++)</span><br><span class="line">        print_ten_integers();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Can use Valgrind to detect memory leaks<h1 id="The-C-Standard-Library"><a href="#The-C-Standard-Library" class="headerlink" title="The C Standard Library"></a>The C Standard Library</h1></li>
<li>Alreadt saw: <code>printf</code>, <code>malloc</code>, <code>atoi</code>, etc</li>
<li>can use <code>man &lt;function name&gt;</code> to find function description, prototype, required headers, return value in a <em>Linux terminal</em><h2 id="String-Copy"><a href="#String-Copy" class="headerlink" title="String Copy"></a>String Copy</h2>The format of String copy:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">strcpy</span><span class="params">(<span class="keyword">char</span> *dest, <span class="keyword">const</span> <span class="keyword">char</span> *src)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">strncpy</span><span class="params">(<span class="keyword">char</span> *dest, <span class="keyword">const</span> <span class="keyword">char</span> *src, <span class="keyword">size_t</span> n)</span></span>;</span><br></pre></td></tr></table></figure>
Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *string1 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> *string2 = string1;   <span class="comment">// this is not a string copy!</span></span><br><span class="line">    <span class="keyword">char</span> string3[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* not super safe, what happen if string1 &gt; string3? */</span></span><br><span class="line">    <span class="built_in">strcpy</span>(string3, string1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* better */</span></span><br><span class="line">    <span class="built_in">strncpy</span>(string3, string1, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;string1 @%p: %s\n&quot;</span>, string1, string1); <span class="comment">// string1 @0x55bcccbf98a4: hello</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;string2 @%p: %s\n&quot;</span>, string2, string2); <span class="comment">// string1 @0x55bcccbf98a4: hello</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;string3 @%p: %s\n&quot;</span>, string3, string3); <span class="comment">// string3 @0x7ffda803dbee: hello</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="String-Concatenation-连结"><a href="#String-Concatenation-连结" class="headerlink" title="String Concatenation 连结"></a>String Concatenation 连结</h2>The format of String Concatenation:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">strcat</span><span class="params">(<span class="keyword">char</span> *dest, <span class="keyword">const</span> <span class="keyword">char</span> *src)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">strncat</span><span class="params">(<span class="keyword">char</span> *dest, <span class="keyword">const</span> <span class="keyword">char</span> *src, <span class="keyword">size_t</span> n)</span></span>;</span><br></pre></td></tr></table></figure>
Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> world[<span class="number">6</span>] = <span class="string">&quot;world&quot;</span>;</span><br><span class="line">  <span class="keyword">char</span> s1[<span class="number">32</span>];</span><br><span class="line">  <span class="keyword">char</span> s2[<span class="number">32</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(s1, <span class="string">&quot;hello &quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(s2, <span class="string">&quot;hello &quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcat</span>(s1, world);       <span class="comment">// not very safe</span></span><br><span class="line">  <span class="built_in">strncat</span>(s2, world, <span class="number">32</span>);  <span class="comment">// better</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;s1: %s\n&quot;</span>, s1); <span class="comment">//s1: hello world</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;s2: %s\n&quot;</span>, s2); <span class="comment">//s2: hello world</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Format-based-String-Creation"><a href="#Format-based-String-Creation" class="headerlink" title="Format-based String Creation"></a>Format-based String Creation</h2>Format is:</li>
</ul>
<p><code>int sprintf(char *str, const char *format, ...);</code><br>Fill a string with printf-like specifiers 用类似 printf 的说明符填充字符串</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">float</span> b = <span class="number">4.5</span>;</span><br><span class="line">    <span class="keyword">char</span> *s = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> <span class="built_in">string</span>[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sprintf</span>(<span class="built_in">string</span>, <span class="string">&quot;a is %d, b is %f, s is %s\n&quot;</span>, a, b, s);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="built_in">string</span>); <span class="comment">// a is 12, b is 4.500000, s is hello</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="String-Manipulation"><a href="#String-Manipulation" class="headerlink" title="String Manipulation"></a>String Manipulation</h2><ul>
<li>Get string length with <code>strlen</code></li>
<li>Compare two strings with <code>strcmp</code>, returns 0 if they match<br>The formats of them are:</li>
</ul>
<p><code>size_t strlen(const char *s)</code></p>
<p><code>int strcmp(const char *s1, const char *s2);</code></p>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="keyword">char</span> *s1 = <span class="string">&quot;hello&quot;</span>; <span class="keyword">char</span> *s2 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> *s3 = <span class="string">&quot;not hello&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;strcmp(s1, s2) returns: %d\n&quot;</span>, <span class="built_in">strcmp</span>(s1, s2));   <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;strcmp(s1, s3) returns: %d\n&quot;</span>, <span class="built_in">strcmp</span>(s1, s3));   <span class="comment">// -6</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;length of s1: %d\n&quot;</span>, <span class="built_in">strlen</span>(s1)); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;length of s2: %d\n&quot;</span>, <span class="built_in">strlen</span>(s2)); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;length of s3: %d\n&quot;</span>, <span class="built_in">strlen</span>(s3)); <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>
<h2 id="Console-Input"><a href="#Console-Input" class="headerlink" title="Console Input"></a>Console Input</h2><p>Formats:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">fgets</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> size, FILE *stream)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">scanf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *format, ...)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fgets()</code> can read from any open file, but <code>scanf()</code> only reads standard input.</li>
<li><code>fgets()</code> reads ‘a line of text’ from a file; <code>scanf()</code> can be used for that but also handles conversions from string to built in numeric types.</li>
<li>Many people will use <code>fgets()</code> to read a line of data and then use <code>scanf()</code> to dissect it. From <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1252132/difference-between-scanf-and-fgets#:~:text=fgets()%20can%20read%20from,to%20built%20in%20numeric%20types.">stackoverflow</a></li>
</ul>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> int1, int2;</span><br><span class="line">  <span class="keyword">double</span> double1;</span><br><span class="line">  <span class="keyword">float</span> float1;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">128</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input a string:\n&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">128</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input an integer:\n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;int1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input a float:\n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;double1); <span class="comment">/* make sure to us %lf for double and %f for float */</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please enter an integer and a float separated by a space\n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d %f&quot;</span>, &amp;int2, &amp;float1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You have entered: %d, %d, %lf, %f, and %s\n&quot;</span>, int1, int2, double1,</span><br><span class="line">          float1, s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Memory-Manipulation"><a href="#Memory-Manipulation" class="headerlink" title="Memory Manipulation"></a>Memory Manipulation</h2><ul>
<li>Writing bytes to memory, Copying memory<br>Formats:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">memset</span><span class="params">(<span class="keyword">void</span> *s, <span class="keyword">int</span> c, <span class="keyword">size_t</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">memcpy</span><span class="params">(<span class="keyword">void</span> *dest, <span class="keyword">void</span> *src, <span class="keyword">size_t</span> n)</span></span>;</span><br></pre></td></tr></table></figure>
<code>memset</code> sets for char (or other type) variable, make <code>n</code> size of it to <code>c</code></li>
</ul>
<p><code>memcpy</code> copy from <code>src</code> to <code>dest</code> in the size of <code>n</code><br>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;   // needed for memcpy and memset</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> buffer_size = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">char</span> *ptr1  = <span class="built_in">malloc</span>(buffer_size);</span><br><span class="line">    <span class="keyword">char</span> *ptr2 = <span class="built_in">malloc</span>(buffer_size);</span><br><span class="line">    <span class="keyword">if</span>(ptr1 &amp;&amp; ptr2) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(ptr1, <span class="number">0x40</span>, buffer_size);  <span class="comment">// 0x40 is ascii code for @</span></span><br><span class="line">        <span class="built_in">memcpy</span>(ptr2, ptr1, buffer_size);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;buffer_size; i++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ptr1[%d] = %c\n&quot;</span>, i, ptr1[i]); <span class="comment">//ptr1[0] = @</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ptr2[%d] = %c\n&quot;</span>, i, ptr2[i]); <span class="comment">//ptr2[0] = @ all are set to @!</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Math-functions"><a href="#Math-functions" class="headerlink" title="Math functions"></a>Math functions</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">ceil</span><span class="params">(<span class="keyword">double</span> x)</span></span>; <span class="comment">// the ceil function returns the smallest integer that is greater than or equal to x</span></span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">ceilf</span><span class="params">(<span class="keyword">float</span> x)</span></span>;  <span class="comment">// the same result as ceil</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sqrt</span><span class="params">(<span class="keyword">double</span> x)</span></span>; <span class="comment">// square root</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">pow</span><span class="params">(<span class="keyword">double</span> x)</span></span>; <span class="comment">// power</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cos</span><span class="params">(<span class="keyword">double</span> x)</span></span>; <span class="comment">//cosine function</span></span><br></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; // needed for math functions</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ceil 2.5:  %f\n&quot;</span>, <span class="built_in">ceil</span>(<span class="number">2.5</span>)); <span class="comment">//ceil 2.5:  3.000000</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ceilf 2.5:  %f\n&quot;</span>, ceilf(<span class="number">2.5</span>)); <span class="comment">//ceilf 2.5:  3.000000</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;floor 2.5: %f\n&quot;</span>, <span class="built_in">floor</span>(<span class="number">2.5</span>)); <span class="comment">//floor 2.5: 2.000000</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;2^5:       %f\n&quot;</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">5</span>)); <span class="comment">//2^5:       32.000000</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sqrt(4):   %f\n&quot;</span>, <span class="built_in">sqrt</span>(<span class="number">4</span>)); <span class="comment">//sqrt(4):   2.000000</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Time"><a href="#Time" class="headerlink" title="Time"></a>Time</h2><ul>
<li>Sleeping<ul>
<li>format<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sleep</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> seconds)</span></span>; <span class="comment">// parameter as second</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">usleep</span><span class="params">(<span class="keyword">useconds_t</span> usec)</span></span>; <span class="comment">//suspends the current process for the number of microseconds passed to it</span></span><br></pre></td></tr></table></figure></li>
<li>1 s = 1000000 µs</li>
<li>Example<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt; // needed for sleep and usleep</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello!\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Sleeping for 2 seconds ...\n&quot;</span>);</span><br><span class="line">    sleep(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Now sleeping for .5 seconds ...\n&quot;</span>);</span><br><span class="line">    usleep(<span class="number">500000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Current Time<ul>
<li>format<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">time_t</span> <span class="title">time</span><span class="params">(<span class="keyword">time_t</span> *tloc)</span></span>;   <span class="comment">// time_t is generally a long long unsigned int</span></span><br></pre></td></tr></table></figure></li>
<li>Example<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;   // needed for time()</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> t = time(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Number of seconds elapsed since the epoch (01/01/1970):\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%llu\n&quot;</span>, t); <span class="comment">// 1650917906</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Measuring Execution Time<ul>
<li>Format<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gettimeofday</span><span class="params">(struct timeval *tv, struct timezone *tz)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timeval</span> &#123;</span></span><br><span class="line">    <span class="keyword">time_t</span>      tv_sec;     <span class="comment">/* seconds (type: generally long unsigned) */</span></span><br><span class="line">    <span class="keyword">suseconds_t</span> tv_usec;    <span class="comment">/* microseconds (type: generally long unsigned) */</span></span><br><span class="line"> &#125;;</span><br><span class="line"> <span class="comment">// A pointer to a struct timeval as parameter</span></span><br></pre></td></tr></table></figure></li>
<li>Example<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/time.h&gt; // needed for gettimeofday</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timeval</span> <span class="title">tv</span>, <span class="title">start</span>, <span class="title">stop</span>, <span class="title">elapsed</span>;</span></span><br><span class="line">    gettimeofday(&amp;tv, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Seconds since the epoch: %lu.%06lu\n&quot;</span>, tv.tv_sec, tv.tv_usec); <span class="comment">// get second and microsecond</span></span><br><span class="line">    gettimeofday(&amp;start, <span class="literal">NULL</span>); <span class="comment">// set a start time stamp</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000000000</span>; i++); <span class="comment">// implementing a large loop</span></span><br><span class="line">    gettimeofday(&amp;stop, <span class="literal">NULL</span>); <span class="comment">// set an ending time stamp</span></span><br><span class="line">    timersub(&amp;stop, &amp;start, &amp;elapsed); <span class="comment">// stop-start = elapsed</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Busy loop took %lu.%06lu seconds\n&quot;</span>, elapsed.tv_sec,</span><br><span class="line">            elapsed.tv_usec);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="File-I-O"><a href="#File-I-O" class="headerlink" title="File I/O"></a>File I/O</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">open</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *pathname, <span class="keyword">int</span> flags, <span class="keyword">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>open</code> creates a reference to a file: <em>file descriptor</em><ul>
<li><code>pathname</code>: path of the file</li>
<li><code>flags</code>:<ul>
<li>Access mode: <code>O_RDONLY</code>, <code>O_WRONLY</code>, <code>O_RDWR</code></li>
<li>create the file if it doesn’t exist: <code>O_CREAT</code></li>
<li>Truncate截短 the file size to 0 if it exists: <code>O_TRUNC</code><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// open /home/pierre/test, read-write mode, and create the file if it does not</span></span><br><span class="line"><span class="comment">// exists with r/w/x permissions</span></span><br><span class="line"><span class="comment">// I_IRWXU means read, write, execute/search by</span></span><br><span class="line"><span class="keyword">int</span> file_descriptor = open(<span class="string">&quot;/home/pierre/test&quot;</span>, O_RDWR | O_CREAT, S_IRWXU);</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><code>read</code> attempts to read bytes from a file<ul>
<li><code>fd</code> is the file descriptor, previously created with <code>open</code></li>
<li><code>buf</code> is the address of the buffer that will receive the content road</li>
<li><code>count</code> is the number of bytes to try to read</li>
<li>return the number of bytes <em>actually</em> read<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> bytes_read = (file_descriptor, buffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(bytes_read == <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">/* error */</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(bytes_read != <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="comment">/* technically not an error */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>write</code> attemps to write <code>count</code> bytes from <code>buf</code> int the file corresponding to <code>fd</code><ul>
<li>Returns the number of bytes actually written</li>
<li>File system can be full<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> bytes_written = (file_descriptor, buffer, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(bytes_written == <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">/* error */</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(bytes_written != <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="comment">/* technically not an error */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">close</span><span class="params">(<span class="keyword">int</span> fd)</span></span></span><br></pre></td></tr></table></figure></li>
<li><code>close</code> terminates file I/O on a given descriptor<br>Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;  // needed for open</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;   // needed for open</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;      // needed for open</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;     // needed for read and write</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> fd1;</span><br><span class="line">  <span class="keyword">char</span> *buffer = <span class="string">&quot;hello, world!&quot;</span>;</span><br><span class="line">  fd1 = open(<span class="string">&quot;./test&quot;</span>, O_WRONLY | O_TRUNC | O_CREAT, S_IRUSR | S_IWUSR);</span><br><span class="line">  <span class="keyword">if</span>(fd1 == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;error with open\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* write &#x27;hello, world!&#x27; in the file */</span></span><br><span class="line">  <span class="keyword">if</span>(write(fd1, buffer, <span class="built_in">strlen</span>(buffer)) != <span class="built_in">strlen</span>(buffer)) &#123;</span><br><span class="line">    <span class="comment">// write will return the number of bytes actualy written</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;issue writing\n&quot;</span>);</span><br><span class="line">      close(fd1); <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* write it again */</span></span><br><span class="line">  <span class="keyword">if</span>(write(fd1, buffer, <span class="built_in">strlen</span>(buffer)) != <span class="built_in">strlen</span>(buffer)) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;issue writing\n&quot;</span>);</span><br><span class="line">      close(fd1); <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  close(fd1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
The result is a txt file called “test” with “hello, world!hello, world!<br>“ in it.</li>
</ul>
</li>
</ul>
<p>Read Example which assume the last example has executed</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assume ./test was previously created with the write example program</span></span><br><span class="line"><span class="keyword">char</span> buffer2[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> fd2 = open(<span class="string">&quot;./test&quot;</span>, O_RDONLY, <span class="number">0x0</span>);</span><br><span class="line"><span class="keyword">int</span> bytes_read;</span><br><span class="line"><span class="keyword">if</span>(fd2 == <span class="number">-1</span>) &#123; <span class="built_in">printf</span>(<span class="string">&quot;error open\n&quot;</span>); <span class="keyword">return</span> <span class="number">-1</span>; &#125;</span><br><span class="line"><span class="comment">/* read 9 bytes */</span></span><br><span class="line"><span class="keyword">if</span>(read(fd2, buffer2, <span class="number">9</span>) != <span class="number">9</span>) &#123; <span class="comment">//read 9 bytes from fd2 to buffer 2</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error reading\n&quot;</span>); close(fd2); <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* fix the string and print it */</span></span><br><span class="line">buffer2[<span class="number">10</span>] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">//read: &#x27;hello, wo&#x27;</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;read: &#x27;%s&#x27;\n&quot;</span>, buffer2);</span><br><span class="line"><span class="comment">/* read 9 bytes again */</span></span><br><span class="line">bytes_read = read(fd2, buffer2, <span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span>(bytes_read != <span class="number">9</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error reading\n&quot;</span>); close(fd2); <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* fix the string and print it */</span></span><br><span class="line">buffer2[<span class="number">10</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;read: &#x27;%s&#x27;\n&quot;</span>, buffer2); <span class="comment">//read: &#x27;rld!hello&#x27;</span></span><br><span class="line">close(fd2);</span><br></pre></td></tr></table></figure>
<h2 id="Random-Numbers"><a href="#Random-Numbers" class="headerlink" title="Random Numbers"></a>Random Numbers</h2><ul>
<li>V1: get numbers between 0 and RAND_MAX<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, rand());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>); <span class="comment">// 1804289383 846930886 1681692777 1714636915 1957747793 424238335 719885386 1649760492 596516649 1189641421 </span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>V2: numbers between 0 and 99 with modulo<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, rand()%<span class="number">100</span>); <span class="comment">// 83 86 77 15 93 35 86 92 49 21 </span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>V3: display a different sequence each time we launch the program<ul>
<li>makes use of the computer’s internal clock to control the choice of the seed. Since time is continually changing, the seed is forever changing.</li>
<li> void srand(unsigned int seed) seeds the random number generator used by the function rand.</li>
<li> <code>seed</code> − This is an integer value to be used as seed by the pseudo-random number generator algorithm.</li>
<li>Because the number is set after compiling the program!<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, rand()%<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Error-Management"><a href="#Error-Management" class="headerlink" title="Error Management"></a>Error Management</h2></li>
</ul>
</li>
<li>The variable <code>errno</code> can be used to get more information about the failure of many functions of the standard library<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;  // needed for errno and perror</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> fd = open(<span class="string">&quot;a/file/that/does/not/exist&quot;</span>, O_RDONLY, <span class="number">0x0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Open always returns -1 on failure, but it can be due to many different</span></span><br><span class="line"><span class="comment">    * reasons */</span></span><br><span class="line">  <span class="keyword">if</span>(fd == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;open failed! errno is: %d\n&quot;</span>, errno);</span><br><span class="line">      <span class="comment">// the errno is 2</span></span><br><span class="line">      <span class="comment">/* errno is an integer code corresponding to a given reason. To format</span></span><br><span class="line"><span class="comment">        * it in a textual way use perror: */</span></span><br><span class="line">      perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Errors are listed, more can find in the <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man3/errno.3.html">function man page</a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> 1   EPERM             Operation not permitted</span><br><span class="line"> 2   ENOENT            No such file or directory</span><br><span class="line"> 3   ESRCH             No such process</span><br><span class="line"> 4   EINTR             Interrupted system call</span><br><span class="line"> 5   EIO               Input&#x2F;output error</span><br><span class="line"> 6   ENXIO             No such device or address</span><br><span class="line"> 7   E2BIG             Argument list too long</span><br><span class="line"> 8   ENOEXEC           Exec format error</span><br><span class="line"> 9   EBADF             Bad file descriptor</span><br><span class="line">10   ECHILD            No child processes</span><br></pre></td></tr></table></figure>
<h1 id="Classes-and-Objects-in-C"><a href="#Classes-and-Objects-in-C" class="headerlink" title="Classes and Objects in C++"></a>Classes and Objects in C++</h1></li>
<li>Superset of C with many additional functionalities, in particular Object-Oriented Programming (OOP)<ul>
<li>Everything we saw for C will also work in C++</li>
</ul>
</li>
<li>3 fundamental concepts of OOP:<ul>
<li>Encapsulation of data and code manipulating it with classes and objects</li>
<li>Inheritance, that helps to <em>reuse</em> code for components of a program that share similar characteristics</li>
<li>Polymorphism多态性 lets the programmer define multiple implementation of functions with the same name<h2 id="Classes-and-Objects"><a href="#Classes-and-Objects" class="headerlink" title="Classes and Objects"></a>Classes and Objects</h2></li>
</ul>
</li>
<li>Object Oriented Programming binds together some data and the code that is manipulating it into objects</li>
<li>The code for manipulating similar objects is defined once into a class</li>
<li>The programmer uses the class as a pattern to create (instantiate) as many objects as needed</li>
<li>By convention, class names start with a capital letter and use camel case</li>
<li>Member variables represent data attached to the object created from the class<ul>
<li>Different objects of the same class can have different values for member variables</li>
</ul>
</li>
<li>Member variables represent data attached to the object created from the class Member functions are functions, i.e. the code manipulating the data<ul>
<li>Prototype原型 in the class, implemented outside with :: </li>
</ul>
</li>
<li>Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleClass</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> val)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SampleClass::add</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    data = data + val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// create two objects, instances of SampleClass</span></span><br><span class="line">  SampleClass obj1, obj2;</span><br><span class="line">  obj1.data = <span class="number">42</span>;</span><br><span class="line">  obj2.data = <span class="number">12</span>;</span><br><span class="line">  obj1.add(<span class="number">58</span>);</span><br><span class="line">  obj2.add(<span class="number">8</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj1 data: %d\n&quot;</span>, obj1.data); <span class="comment">//obj1 data: 100</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj2 data: %d\n&quot;</span>, obj2.data); <span class="comment">//obj2 data: 20</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Encapsulation"><a href="#Encapsulation" class="headerlink" title="Encapsulation"></a>Encapsulation</h2></li>
<li>Encapsulation: prevent <em>direct access</em> to part of the member variables/functions of a class from outside of this class<ul>
<li>To force the outside code to use a well-defined interface, i.e. the member functions and (rarely) variables still available to it<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> &#123;</span></span><br><span class="line"><span class="comment">// All attributes/methods set as private are unacessible from outside the class</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> _balance = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> _transaction_num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update_balance</span><span class="params">(<span class="keyword">int</span> val)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_balance</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_transaction_num</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Add val to the balance and increment the number of transactions */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BankAccount::update_balance</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    _balance += val;</span><br><span class="line">    _transaction_num++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the current value of the balance */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BankAccount::get_balance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the number of transactions */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BankAccount::get_transaction_num</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _transaction_num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    BankAccount ba;</span><br><span class="line">    ba.update_balance(<span class="number">100</span>); <span class="comment">// payday 发薪日</span></span><br><span class="line">    ba.update_balance(<span class="number">-20</span>); <span class="comment">// groceries 杂货</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The account balance is %d after %d transactions\n&quot;</span>,</span><br><span class="line">            ba.get_balance(), ba.get_transaction_num());</span><br><span class="line">    <span class="comment">// output: The account balance is 80 after 2 transactions</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Have as much member variables private as possible</li>
<li>Have funcions to read/write these only if needed<ul>
<li>Use accessors or getters and setters</li>
<li>Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> _foo = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> _bar = <span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_foo</span><span class="params">(<span class="keyword">int</span> val)</span></span>; <span class="comment">// setter</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_foo</span><span class="params">()</span></span>;         <span class="comment">// getter</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">get_bar</span><span class="params">()</span></span>;      <span class="comment">// getter</span></span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyClass::set_foo</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    _foo = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MyClass::get_foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _foo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">MyClass::get_bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _bar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    MyClass c1, c2;</span><br><span class="line">    c1.set_foo(<span class="number">42</span>);</span><br><span class="line">    c2.set_foo(<span class="number">24</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;c1&#x27;s foo: %d, c2&#x27;s foo: %d\n&quot;</span>, c1.get_foo(), c2.get_foo());</span><br><span class="line">    <span class="comment">// c1&#x27;s foo: 42, c2&#x27;s foo: 24</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h2></li>
</ul>
</li>
<li>Initialise member variables at object creation time with a constructor<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> &#123;</span></span><br><span class="line"><span class="comment">// All attributes/methods set as private are unacessible from outside the class</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> _balance;</span><br><span class="line">    <span class="keyword">int</span> _transaction_num;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BankAccount(<span class="keyword">int</span> initial_balance);</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update_balance</span><span class="params">(<span class="keyword">int</span> val)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_balance</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_transaction_num</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Constructor */</span></span><br><span class="line"><span class="comment">// now can set any value as intitial balance</span></span><br><span class="line">BankAccount::BankAccount(<span class="keyword">int</span> initial_balance) &#123;</span><br><span class="line">    _balance = initial_balance;</span><br><span class="line">    _transaction_num = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Destructors"><a href="#Destructors" class="headerlink" title="Destructors"></a>Destructors</h2></li>
<li>Member functions called when the object is destroyed<br>I.e. when it goes out of scope for the stack-allocated objects we have seen this far<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> &#123;</span></span><br><span class="line"><span class="comment">// All attributes/methods set as private are unacessible from outside the class</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> _balance;</span><br><span class="line">    <span class="keyword">int</span> _transaction_num;</span><br><span class="line">    <span class="keyword">char</span> *_account_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BankAccount(<span class="keyword">char</span> *name, <span class="keyword">int</span> initial_balance);</span><br><span class="line">    ~BankAccount();</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update_balance</span><span class="params">(<span class="keyword">int</span> val)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_balance</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_transaction_num</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">char</span> *<span class="title">get_name</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Constructor */</span></span><br><span class="line">BankAccount::BankAccount(<span class="keyword">char</span> *name, <span class="keyword">int</span> initial_balance) &#123;</span><br><span class="line">    _balance = initial_balance;</span><br><span class="line">    _transaction_num = <span class="number">0</span>;</span><br><span class="line">    _account_name =</span><br><span class="line">        (<span class="keyword">char</span> *)<span class="built_in">malloc</span>((<span class="built_in">strlen</span>(name) + <span class="number">1</span>) * <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">    <span class="built_in">strcpy</span>(_account_name, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* destructor */</span></span><br><span class="line">BankAccount::~BankAccount() &#123;</span><br><span class="line">    <span class="built_in">free</span>(_account_name);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// printf here to see when the destructor is called:</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;destructor called\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Add val to the balance and increment the number of transactions */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BankAccount::update_balance</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    _balance += val;</span><br><span class="line">    _transaction_num++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the current value of the balance */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BankAccount::get_balance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the number of transactions */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BankAccount::get_transaction_num</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _transaction_num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the name of the account */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">BankAccount::get_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _account_name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">11</span>] = <span class="string">&quot;my_account&quot;</span>;</span><br><span class="line">    <span class="function">BankAccount <span class="title">ba</span><span class="params">(name, <span class="number">100</span>)</span></span>; <span class="comment">//set name and initial balance</span></span><br><span class="line"></span><br><span class="line">    ba.update_balance(<span class="number">100</span>); <span class="comment">// payday</span></span><br><span class="line">    ba.update_balance(<span class="number">-20</span>); <span class="comment">// groceries</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The account \&quot;%s\&quot; balance is %d after %d transactions\n&quot;</span>,</span><br><span class="line">            ba.get_name(), ba.get_balance(), ba.get_transaction_num());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The output is:</span></span><br><span class="line"><span class="comment">//The account &quot;my_account&quot; balance is 180 after 2 transactions</span></span><br><span class="line"><span class="comment">// destructor called</span></span><br></pre></td></tr></table></figure>
<h2 id="This-Pointer"><a href="#This-Pointer" class="headerlink" title="This Pointer"></a>This Pointer</h2></li>
<li>In any member function (including destructors and constructors), one can obtain a pointer to the current object with this<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Test(<span class="keyword">int</span> x, <span class="keyword">int</span> y);</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* This constructor&#x27;s parameter have the same names as the class member</span></span><br><span class="line"><span class="comment"> * variables */</span></span><br><span class="line">Test::Test(<span class="keyword">int</span> x, <span class="keyword">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;x = x; <span class="comment">// x corresponds to the parameter, this-&gt;x to the member</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;y = y; <span class="comment">// this-&gt;x equal to (*this).x</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test::print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x: %d, y: %d\n&quot;</span>, x, y);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x: %d, y: %d\n&quot;</span>, <span class="keyword">this</span>-&gt;x, <span class="keyword">this</span>-&gt;y);  <span class="comment">// same thing</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="function">Test <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>)</span></span>;</span><br><span class="line">    t.print();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C-Dynamic-Object-Allocation-and-Dynamic-Arrays"><a href="#C-Dynamic-Object-Allocation-and-Dynamic-Arrays" class="headerlink" title="C++: Dynamic Object Allocation and Dynamic Arrays"></a>C++: Dynamic Object Allocation and Dynamic Arrays</h1><h2 id="Dynamic-Object-Allocation"><a href="#Dynamic-Object-Allocation" class="headerlink" title="Dynamic Object Allocation"></a>Dynamic Object Allocation</h2></li>
<li><code>malloc</code> and <code>free</code> are available in C++<ul>
<li>Good for allocating arrays/buffers of primitive原始 types(<code>int</code>, <code>char</code>, etc.)</li>
</ul>
</li>
<li><code>new</code> and <code>delete</code> to allocate objects dynamically<ul>
<li>Use <code>malloc</code> and <code>free</code> under the hood</li>
<li>Allocate memory and invoke contructors/destructors<ul>
<li>Should be preferred to malloc/free 优先于malloc/free<h2 id="Dynamic-Arrays"><a href="#Dynamic-Arrays" class="headerlink" title="Dynamic Arrays"></a>Dynamic Arrays</h2></li>
</ul>
</li>
</ul>
</li>
<li>vector class</li>
<li>Variable size arrays, their allocated memory (on the heap) is managed automatically by the language</li>
<li>They also embed their size<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt; // c++ include</span></span></span><br><span class="line"><span class="comment">// vector is in the std namespace</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">/* apply a few random transactions on account pairs within the array</span></span><br><span class="line"><span class="comment"> * Note that we have a dynamic array which embeds its size so no need to pass</span></span><br><span class="line"><span class="comment"> * the number of accounts as parameter anymore</span></span><br><span class="line"><span class="comment"> * Also note that we pass a pointer to the vector rather than the vector</span></span><br><span class="line"><span class="comment"> * to avoid a costly copy with long vectors! */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rnd_transac</span><span class="params">(<span class="built_in">vector</span>&lt;BankAccount *&gt; *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = rand()%<span class="number">10</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> n = b-&gt;size();  <span class="comment">// returns the amount of elements in the vector</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;num; i++) &#123;</span><br><span class="line">        BankAccount *source = (*b)[rand()%n]; <span class="comment">// we can access a vector with []</span></span><br><span class="line">        BankAccount *target = (*b)[rand()%n];</span><br><span class="line">        <span class="keyword">int</span> amount = rand()%<span class="number">15</span>;</span><br><span class="line">        target-&gt;update_balance(amount);</span><br><span class="line">        source-&gt;update_balance(-amount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// a vector of BankAccount pointers:</span></span><br><span class="line">  <span class="built_in">vector</span>&lt;BankAccount *&gt; accounts;</span><br><span class="line">  <span class="keyword">int</span> n;</span><br><span class="line">  n = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">32</span>];</span><br><span class="line">    <span class="built_in">sprintf</span>(name, <span class="string">&quot;account %d&quot;</span>, i);</span><br><span class="line">    BankAccount *b = <span class="keyword">new</span> BankAccount(name, <span class="number">100</span>);</span><br><span class="line">    accounts.push_back(b); <span class="comment">// add an element at the end of the vector</span></span><br><span class="line">  &#125;</span><br><span class="line">  rnd_transac(&amp;accounts);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">    BankAccount *b = accounts[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="comment">/* ... */</span>);</span><br><span class="line">    <span class="comment">// this frees what is pointed by b but does not remove b from the</span></span><br><span class="line">    <span class="comment">// vector, we&#x27;ll clear it out below as we are currently iterating on</span></span><br><span class="line">    <span class="comment">// that vector</span></span><br><span class="line">    <span class="keyword">delete</span> b;</span><br><span class="line">  &#125;</span><br><span class="line">  accounts.clear(); <span class="comment">// remove all elements from the vector</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/C/" rel="tag"># C</a>
              <a href="/tags/26020-Programming-Languages-and-Paradigms/" rel="tag"># 26020 Programming Languages and Paradigms</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/09/03/%E7%AE%97%E6%B3%95%EF%BC%9A%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97%E3%80%81%E9%93%BE%E8%A1%A8/" rel="prev" title="算法：栈、队列、链表">
                  <i class="fa fa-chevron-left"></i> 算法：栈、队列、链表
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="SOHUCS"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yangyang Cui</span>
</div>
<div class="busuanzi-count">
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <script>
  NexT.utils.loadComments('#SOHUCS', () => {
    NexT.utils.getScript('https://changyan.sohu.com/upload/changyan.js', () => {
      window.changyan.api.config({
        appid: 'cyvwQmbJm',
        conf : '43966006cd9b05b30c6a1930cb05447c'
      });
    });
  });
  </script>
  <script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
